using SerpentCore.Core;
using SerpentCore.Core.Managers;
using Serpent.Loader;
using UnityEngine;
using VRCSDK2;

namespace Serpent.Components
{
    internal class ExploitMidnightComponent : ModComponent
    {

        public ExploitMidnightComponent()
        {

        }


        public override void OnUiManagerInit(UiManager uiManager)
        {
            base.OnUiManagerInit(uiManager);

            var subMenu = uiManager.MainMenu.GetMenuPage(Page.PageNames.WorldCheats);
            var cheatMenu = subMenu.AddMenuPage("Midnight Rooftop", "Midnight Rooftop things", ResourceManager.GetSprite("remodce.world"));

            cheatMenu.AddButton($"Remove underwater effect", "Remove pool underwater effect", delegate { JustH("Underwater PP", false); }, ResourceManager.GetSprite("remodce.exit-door"));

        }

        public static void JustH(string gameObjectName, bool state)
        {
            if (RoomManager.field_Internal_Static_ApiWorld_0.id == "wrld_d29bb0d0-d268-42dc-8365-926f9d485505")
            {
                foreach (GameObject gameObject in Resources.FindObjectsOfTypeAll<GameObject>())
                {
                    bool roomActive = gameObject.name.Contains(gameObjectName);
                    if (roomActive)
                    {
                        gameObject.SetActive(state);
                    }
                }
                ReLogger.Msg("turning off " + gameObjectName);
                Serpent.LogDebug("Turning off " + gameObjectName);
            }
            else
            {
                ReLogger.Msg("You are not in the midnight rooftop");
                Serpent.LogDebug("You are not in the midnight rooftop");
            }
        }
    }
}
